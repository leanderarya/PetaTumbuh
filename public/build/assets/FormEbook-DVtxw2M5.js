import{r as m,m as B,j as e,L as k,S as j}from"./app-B6QmsnAk.js";import{A as C}from"./app-layout-xkMIcb9Q.js";import{S as n}from"./sweetalert2.esm.all-BQIkj5Wb.js";/* empty css            */import"./button-DEKkQh_T.js";import"./index-D7BoANQl.js";import"./index-_Zj6GiA9.js";import"./x-BWRYX-Wq.js";import"./createLucideIcon-sGOIyxpM.js";import"./app-logo-icon-B_SSAznH.js";const D=[{title:"Dashboard",href:"/dashboard"},{title:"Manajemen E-Book",href:"/upload-ebook"}];function J({editingEbook:t,ebooks:p}){const[c,x]=m.useState((t==null?void 0:t.id)??null),{data:a,setData:o,post:w,processing:u,errors:r,reset:h}=B({title:(t==null?void 0:t.title)||"",description:(t==null?void 0:t.description)||"",file:null,cover:null,is_new:(t==null?void 0:t.is_new)??!0}),[f,d]=m.useState((t==null?void 0:t.cover_preview)||null);m.useEffect(()=>{if(a.cover){const s=new FileReader;s.onloadend=()=>d(s.result),s.readAsDataURL(a.cover)}else t!=null&&t.cover_preview?d(t.cover_preview):d(null)},[a.cover]);const g=s=>{if(s.preventDefault(),!a.title.trim()||!a.description.trim()){n.fire("Form tidak lengkap","Harap lengkapi judul dan deskripsi.","warning");return}const l=new FormData;l.append("title",a.title),l.append("description",a.description),l.append("is_new",a.is_new?"1":"0"),a.file&&l.append("file",a.file),a.cover&&l.append("cover",a.cover);const i=N=>{n.fire({toast:!0,position:"top-end",icon:"success",title:N,showConfirmButton:!1,timer:3e3}),h(),d(null),x(null)},b=()=>{n.fire("Gagal","Terjadi kesalahan. Periksa kembali isian form Anda.","error")};c?(l.append("_method","PUT"),j.post(`/ebooks/${c}`,l,{forceFormData:!0,onSuccess:()=>i("E-Book berhasil diperbarui!"),onError:b})):w(route("ebooks.store"),{forceFormData:!0,onSuccess:()=>i("E-Book berhasil diunggah!"),onError:b})},v=s=>{n.fire({title:"Yakin ingin menghapus?",text:"Data e-book yang dihapus tidak bisa dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"}).then(l=>{l.isConfirmed&&j.delete(`/ebooks/${s}`,{onSuccess:()=>{n.fire("Berhasil!","E-Book telah dihapus.","success")}})})},y=s=>{o({title:s.title,description:s.description,file:null,cover:null,is_new:s.is_new}),d(s.image),x(s.id),n.fire({toast:!0,position:"top-end",icon:"info",title:"Mode Edit Aktif",showConfirmButton:!1,timer:3e3})};return e.jsxs(C,{breadcrumbs:D,children:[e.jsx(k,{title:"Upload E-Book Edukasi"}),e.jsxs("div",{className:"mx-auto w-full max-w-4xl rounded-2xl bg-white p-4 shadow-lg sm:p-8",children:[e.jsxs("h1",{className:"mb-6 text-xl font-bold text-blue-800 sm:text-2xl",children:["📘 ",c?"Edit E-Book":"Upload E-Book Edukasi"]}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-semibold text-gray-700",children:["Judul E-Book ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",placeholder:"Contoh: Panduan Gizi Anak 2025",className:"w-full rounded-md border border-gray-300 px-4 py-2 text-base focus:border-blue-500 focus:ring-2 focus:ring-blue-100",value:a.title,onChange:s=>o("title",s.target.value),autoComplete:"off"}),r.title&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.title})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-semibold text-gray-700",children:["Deskripsi Singkat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{placeholder:"Tuliskan ringkasan isi e-book...",className:"w-full rounded-md border border-gray-300 px-4 py-2 text-base focus:border-blue-500 focus:ring-2 focus:ring-blue-100",rows:4,value:a.description,onChange:s=>o("description",s.target.value)}),r.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.description})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-semibold text-gray-700",children:["File E-Book (PDF) ",c?"(Opsional)":e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",accept:"application/pdf",className:"block w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base file:mr-4 file:rounded-lg file:border-0 file:bg-blue-100 file:px-4 file:py-2 file:font-semibold file:text-blue-700 hover:file:bg-blue-200",onChange:s=>{var i;const l=((i=s.target.files)==null?void 0:i[0])||null;if(l&&l.size>50*1024*1024){n.fire("Ukuran File Terlalu Besar","File PDF tidak boleh melebihi 50MB.","error"),s.target.value="";return}o("file",l)}}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Format: PDF, maksimal 50MB"}),r.file&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.file})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-semibold text-gray-700",children:["Cover E-Book (JPG/PNG) ",c?"(Opsional)":""]}),e.jsx("input",{type:"file",accept:"image/*",className:"block w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base file:mr-4 file:rounded-lg file:border-0 file:bg-cyan-100 file:px-4 file:py-2 file:font-semibold file:text-cyan-700 hover:file:bg-cyan-200",onChange:s=>{var i;const l=((i=s.target.files)==null?void 0:i[0])||null;if(l&&l.size>5*1024*1024){n.fire("Ukuran File Terlalu Besar","Gambar cover tidak boleh melebihi 5MB.","error"),s.target.value="";return}o("cover",l)}}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Format: JPG/PNG, maksimal 5MB"}),r.cover&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.cover})]}),f&&e.jsx("div",{className:"w-full max-w-xs",children:e.jsx("img",{src:f,alt:"Preview Cover",className:"mt-2 w-full rounded-md border object-cover shadow"})}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx("input",{id:"is_new",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-blue-600",checked:a.is_new,onChange:s=>o("is_new",s.target.checked)}),e.jsxs("label",{htmlFor:"is_new",className:"text-sm text-gray-700",children:["Tampilkan badge ",e.jsx("span",{className:"font-bold text-blue-600",children:"BARU"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse items-stretch justify-end gap-2 pt-4 sm:flex-row sm:items-center",children:[c&&e.jsx("button",{type:"button",onClick:()=>{h(),d(null),x(null)},className:"rounded-lg bg-gray-400 px-6 py-2 text-sm font-semibold text-white hover:bg-gray-500",children:"Batal Edit"}),e.jsx("button",{type:"submit",disabled:u,className:"rounded-lg bg-blue-600 px-6 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:u?"Memproses...":c?"Simpan Perubahan":"Unggah E-Book"})]})]}),p.length>0&&e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold text-gray-800",children:"📚 Daftar E-Book"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border bg-white shadow",children:e.jsxs("table",{className:"w-full min-w-[650px] divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-blue-50 text-xs text-blue-700 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Cover"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Judul"}),e.jsx("th",{className:"max-w-[140px] px-3 py-2 text-left",children:"Deskripsi"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Aksi"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Badge"})]})}),e.jsx("tbody",{children:p.map(s=>e.jsxs("tr",{className:"transition hover:bg-blue-50",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("img",{src:s.image,alt:s.title,className:"h-12 w-9 rounded object-cover sm:h-16 sm:w-12"})}),e.jsx("td",{className:"max-w-[120px] px-3 py-2 font-semibold break-words text-blue-800 sm:max-w-xs",children:e.jsx("span",{className:"line-clamp-2",children:s.title})}),e.jsx("td",{className:"max-w-[140px] px-3 py-2 break-words text-gray-700",children:e.jsx("span",{className:"line-clamp-2",children:s.description})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("a",{href:s.file,target:"_blank",rel:"noopener noreferrer",className:"rounded bg-blue-500 px-2 py-1 text-xs text-white hover:bg-blue-700",title:"Download",children:"📥"}),e.jsx("button",{onClick:()=>y(s),className:"rounded bg-yellow-400 px-2 py-1 text-xs text-white hover:bg-yellow-500",title:"Edit",children:"✏"}),e.jsx("button",{onClick:()=>v(s.id),className:"rounded bg-red-500 px-2 py-1 text-xs text-white hover:bg-red-600",title:"Hapus",children:"🗑"})]})}),e.jsx("td",{className:"px-3 py-2",children:s.is_new&&e.jsx("span",{className:"rounded-full bg-green-100 px-2 py-0.5 text-xs font-bold text-green-700",children:"BARU"})})]},s.id))})]})})]})]})]})}export{J as default};
