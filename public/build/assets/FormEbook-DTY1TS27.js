import{r as m,m as y,j as e,L as v,S as f}from"./app-Dcm-wotV.js";import{A as N}from"./app-layout-CdNzruhD.js";import{S as c}from"./sweetalert2.esm.all-BQIkj5Wb.js";/* empty css            */import"./button-B7RRtJg4.js";import"./index-Po8tA36f.js";import"./index-drXQSo_z.js";import"./x-D3EbcYgH.js";import"./createLucideIcon-BRbmj-aX.js";import"./app-logo-icon-bsRcyjVl.js";const B=[{title:"Dashboard",href:"/dashboard"},{title:"Manajemen E-Book",href:"/upload-ebook"}];function M({editingEbook:l,ebooks:p}){const[d,o]=m.useState((l==null?void 0:l.id)??null),{data:t,setData:n,post:b,processing:u,errors:r,reset:x}=y({title:(l==null?void 0:l.title)||"",description:(l==null?void 0:l.description)||"",file:null,cover:null,is_new:(l==null?void 0:l.is_new)??!0}),[h,i]=m.useState((l==null?void 0:l.cover_preview)||null);m.useEffect(()=>{if(t.cover){const s=new FileReader;s.onloadend=()=>i(s.result),s.readAsDataURL(t.cover)}else l!=null&&l.cover_preview?i(l.cover_preview):i(null)},[t.cover]);const j=s=>{if(s.preventDefault(),!t.title.trim()||!t.description.trim()){c.fire("Form tidak lengkap","Harap lengkapi judul dan deskripsi.","warning");return}const a=new FormData;a.append("title",t.title),a.append("description",t.description),a.append("is_new",t.is_new?"1":"0"),t.file&&a.append("file",t.file),t.cover&&a.append("cover",t.cover),d?(a.append("_method","PUT"),f.post(`/ebooks/${d}`,a,{forceFormData:!0,onSuccess:()=>{c.fire("Berhasil!","E-Book berhasil diperbarui.","success"),x(),i(null),o(null)}})):b(route("ebooks.store"),{forceFormData:!0,onSuccess:()=>{c.fire("Berhasil!","E-Book berhasil diunggah!","success"),x(),i(null)}})},w=s=>{c.fire({title:"Yakin ingin menghapus?",text:"Data e-book yang dihapus tidak bisa dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal"}).then(a=>{a.isConfirmed&&f.delete(`/ebooks/${s}`,{onSuccess:()=>{c.fire("Berhasil!","E-Book telah dihapus.","success")}})})},g=s=>{n({title:s.title,description:s.description,file:null,cover:null,is_new:s.is_new}),i(s.image),o(s.id),c.fire("Mode Edit","Silakan ubah data lalu klik simpan.","info")};return e.jsxs(N,{breadcrumbs:B,children:[e.jsx(v,{title:"Upload E-Book Edukasi"}),e.jsxs("div",{className:"mx-auto w-full max-w-4xl rounded-2xl bg-white p-4 shadow-lg sm:p-8",children:[e.jsx("h1",{className:"mb-6 text-xl font-bold text-blue-800 sm:text-2xl",children:"📘 Upload E-Book Edukasi Gizi & Stunting"}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-semibold text-gray-700",children:["Judul E-Book ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",placeholder:"Contoh: Panduan Gizi Anak 2025",className:"w-full rounded-md border border-gray-300 px-4 py-2 text-base focus:border-blue-500 focus:ring-2 focus:ring-blue-100",value:t.title,onChange:s=>n("title",s.target.value),autoComplete:"off"}),r.title&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.title})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-semibold text-gray-700",children:["Deskripsi Singkat ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{placeholder:"Tuliskan ringkasan isi e-book, misal: Berisi edukasi gizi pada 1000 HPK untuk cegah stunting.",className:"w-full rounded-md border border-gray-300 px-4 py-2 text-base focus:border-blue-500 focus:ring-2 focus:ring-blue-100",rows:4,value:t.description,onChange:s=>n("description",s.target.value)}),r.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.description})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-sm font-semibold text-gray-700",children:["File E-Book (PDF) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",accept:"application/pdf",className:"block w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base file:mr-4 file:rounded-lg file:border-0 file:bg-blue-100 file:px-4 file:py-2 file:font-semibold file:text-blue-700 hover:file:bg-blue-200",onChange:s=>{var a;return n("file",((a=s.target.files)==null?void 0:a[0])||null)},"aria-label":"Upload file PDF e-book"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Format: PDF, maksimal 5MB"}),r.file&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.file})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-semibold text-gray-700",children:"Cover E-Book (JPG/PNG)"}),e.jsx("input",{type:"file",accept:"image/*",className:"block w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-base file:mr-4 file:rounded-lg file:border-0 file:bg-cyan-100 file:px-4 file:py-2 file:font-semibold file:text-cyan-700 hover:file:bg-cyan-200",onChange:s=>{var a;return n("cover",((a=s.target.files)==null?void 0:a[0])||null)},"aria-label":"Upload cover e-book"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Format: JPG/PNG, maksimal 2MB"}),r.cover&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.cover})]}),h&&e.jsx("div",{className:"w-full max-w-xs",children:e.jsx("img",{src:h,alt:"Preview Cover",className:"mt-2 w-full rounded-md border object-cover shadow"})}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx("input",{id:"is_new",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-blue-600",checked:t.is_new,onChange:s=>n("is_new",s.target.checked)}),e.jsxs("label",{htmlFor:"is_new",className:"text-sm text-gray-700",children:["Tampilkan badge ",e.jsx("span",{className:"font-bold text-blue-600",children:"BARU"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse items-stretch justify-end gap-2 pt-4 sm:flex-row sm:items-center",children:[d&&e.jsx("button",{type:"button",onClick:()=>{x(),i(null),o(null)},className:"rounded-lg bg-gray-400 px-6 py-2 text-sm font-semibold text-white hover:bg-gray-500",children:"Batal Edit"}),e.jsx("button",{type:"submit",disabled:u,className:"rounded-lg bg-blue-600 px-6 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:u?"Memproses...":d?"Simpan Perubahan":"Unggah E-Book"})]})]}),p.length>0&&e.jsxs("div",{className:"mt-10",children:[e.jsx("h2",{className:"mb-4 text-lg font-bold text-gray-800",children:"📚 Daftar E-Book"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border bg-white shadow",children:e.jsxs("table",{className:"w-full min-w-[650px] divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-blue-50 text-xs text-blue-700 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Cover"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Judul"}),e.jsx("th",{className:"max-w-[140px] px-3 py-2 text-left",children:"Deskripsi"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Aksi"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Badge"})]})}),e.jsx("tbody",{children:p.map(s=>e.jsxs("tr",{className:"transition hover:bg-blue-50",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("img",{src:s.image,alt:s.title,className:"h-12 w-9 rounded object-cover sm:h-16 sm:w-12"})}),e.jsx("td",{className:"max-w-[120px] px-3 py-2 font-semibold break-words text-blue-800 sm:max-w-xs",children:e.jsx("span",{className:"line-clamp-2",children:s.title})}),e.jsx("td",{className:"max-w-[140px] px-3 py-2 break-words text-gray-700",children:e.jsx("span",{className:"line-clamp-2",children:s.description})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("a",{href:s.file,target:"_blank",rel:"noopener noreferrer",className:"rounded bg-blue-500 px-2 py-1 text-xs text-white hover:bg-blue-700",title:"Download",children:"📥"}),e.jsx("button",{onClick:()=>g(s),className:"rounded bg-yellow-400 px-2 py-1 text-xs text-white hover:bg-yellow-500",title:"Edit",children:"✏"}),e.jsx("button",{onClick:()=>w(s.id),className:"rounded bg-red-500 px-2 py-1 text-xs text-white hover:bg-red-600",title:"Hapus",children:"🗑"})]})}),e.jsx("td",{className:"px-3 py-2",children:s.is_new&&e.jsx("span",{className:"rounded-full bg-green-100 px-2 py-0.5 text-xs font-bold text-green-700",children:"BARU"})})]},s.id))})]})})]})]})]})}export{M as default};
